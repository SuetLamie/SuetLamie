<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.surpass.mvc.system.bas.dao.MemberMapper">
	<resultMap id="BaseResultMap" type="com.surpass.mvc.system.bas.model.Member" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="level" property="level" jdbcType="VARCHAR" />
    <result column="headImg" property="headimg" jdbcType="VARCHAR" />
    <result column="cardNumber" property="cardnumber" jdbcType="VARCHAR" />
    <result column="cardFaceImg" property="cardfaceimg" jdbcType="VARCHAR" />
    <result column="cardConImg" property="cardconimg" jdbcType="VARCHAR" />
    <result column="mobilePhone" property="mobilephone" jdbcType="VARCHAR" />
    <result column="createTime" property="createtime" jdbcType="TIMESTAMP" />
    <result column="commendNo" property="commendno" jdbcType="VARCHAR" />
    <result column="ways" property="ways" jdbcType="VARCHAR" />
    <result column="personNo" property="personno" jdbcType="VARCHAR" />
    <result column="beginTime" property="begintime" jdbcType="TIMESTAMP" />
    <result column="endTime" property="endtime" jdbcType="TIMESTAMP" />
    <result column="password" property="password" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="openId" property="openId" jdbcType="VARCHAR" />
  </resultMap>
	<sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    id, name, level, headImg, cardNumber, cardFaceImg, cardConImg, mobilePhone, createTime, 
    commendNo, ways, personNo, beginTime, endTime, password, status,openId
  </sql>
	<!-- 会员根据ID查询-->
	<select id="selectByPrimaryKey" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="java.lang.Integer">
	select t.*
<!-- 		<include refid="Base_Column_List" /> -->
		
		from t_sys_member t
		where id = #{id,jdbcType=INTEGER}
	</select>
	
	<select id="selectByTopLevel" resultType="Integer" parameterType="java.lang.Integer">
		select getDls(#{id}) id from dual
	</select>
	
	<!-- 会员根据ID删除-->
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		delete from t_sys_member
		where id in (${ids})
	</delete>
	<!-- 会员注册-->
	<insert id="insert" parameterType="com.surpass.mvc.system.bas.model.Member" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    insert into t_sys_member (id, name, level, 
      headImg, cardNumber, cardFaceImg, 
      cardConImg, mobilePhone, createTime, 
      commendNo, ways, personNo, 
      beginTime, endTime, password, 
      status,openId)
    values (#{id,jdbcType=INTEGER}, #{name,jdbcType=VARCHAR}, #{level,jdbcType=VARCHAR}, 
      #{headimg,jdbcType=VARCHAR}, #{cardnumber,jdbcType=VARCHAR}, #{cardfaceimg,jdbcType=VARCHAR}, 
      #{cardconimg,jdbcType=VARCHAR}, #{mobilephone,jdbcType=VARCHAR}, #{createtime,jdbcType=TIMESTAMP}, 
      #{commendno,jdbcType=VARCHAR}, #{ways,jdbcType=VARCHAR}, #{personno,jdbcType=VARCHAR}, 
      #{begintime,jdbcType=TIMESTAMP}, #{endtime,jdbcType=TIMESTAMP}, #{password,jdbcType=VARCHAR}, 
      #{status,jdbcType=VARCHAR},#{openId,jdbcType=VARCHAR})
  </insert>
	
	<insert id="insertSelective" parameterType="com.surpass.mvc.system.bas.model.Member" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    insert into t_sys_member
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="name != null" >
        name,
      </if>
      <if test="level != null" >
        level,
      </if>
      <if test="headimg != null" >
        headImg,
      </if>
      <if test="cardnumber != null" >
        cardNumber,
      </if>
      <if test="cardfaceimg != null" >
        cardFaceImg,
      </if>
      <if test="cardconimg != null" >
        cardConImg,
      </if>
      <if test="mobilephone != null" >
        mobilePhone,
      </if>
      <if test="createtime != null" >
        createTime,
      </if>
      <if test="commendno != null" >
        commendNo,
      </if>
      <if test="ways != null" >
        ways,
      </if>
      <if test="personno != null" >
        personNo,
      </if>
      <if test="begintime != null" >
        beginTime,
      </if>
      <if test="endtime != null" >
        endTime,
      </if>
      <if test="password != null" >
        password,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="openId != null" >
        openId,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="name != null" >
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="level != null" >
        #{level,jdbcType=VARCHAR},
      </if>
      <if test="headimg != null" >
        #{headimg,jdbcType=VARCHAR},
      </if>
      <if test="cardnumber != null" >
        #{cardnumber,jdbcType=VARCHAR},
      </if>
      <if test="cardfaceimg != null" >
        #{cardfaceimg,jdbcType=VARCHAR},
      </if>
      <if test="cardconimg != null" >
        #{cardconimg,jdbcType=VARCHAR},
      </if>
      <if test="mobilephone != null" >
        #{mobilephone,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="commendno != null" >
        #{commendno,jdbcType=VARCHAR},
      </if>
      <if test="ways != null" >
        #{ways,jdbcType=VARCHAR},
      </if>
      <if test="personno != null" >
        #{personno,jdbcType=VARCHAR},
      </if>
      <if test="begintime != null" >
        #{begintime,jdbcType=TIMESTAMP},
      </if>
      <if test="endtime != null" >
        #{endtime,jdbcType=TIMESTAMP},
      </if>
      <if test="password != null" >
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="openId != null" >
        #{openId,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
<update id="updateByPrimaryKeySelective" parameterType="com.surpass.mvc.system.bas.model.Member" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    update t_sys_member
    <set >
      <if test="name != null" >
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="level != null" >
        level = #{level,jdbcType=VARCHAR},
      </if>
      <if test="headimg != null" >
        headImg = #{headimg,jdbcType=VARCHAR},
      </if>
      <if test="cardnumber != null" >
        cardNumber = #{cardnumber,jdbcType=VARCHAR},
      </if>
      <if test="cardfaceimg != null" >
        cardFaceImg = #{cardfaceimg,jdbcType=VARCHAR},
      </if>
      <if test="cardconimg != null" >
        cardConImg = #{cardconimg,jdbcType=VARCHAR},
      </if>
      <if test="mobilephone != null" >
        mobilePhone = #{mobilephone,jdbcType=VARCHAR},
      </if>
      <if test="createtime != null" >
        createTime = #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="commendno != null" >
        commendNo = #{commendno,jdbcType=VARCHAR},
      </if>
      <if test="ways != null" >
        ways = #{ways,jdbcType=VARCHAR},
      </if>
      <if test="personno != null" >
        personNo = #{personno,jdbcType=VARCHAR},
      </if>
      <if test="begintime != null" >
        beginTime = #{begintime,jdbcType=TIMESTAMP},
      </if>
      <if test="endtime != null" >
        endTime = #{endtime,jdbcType=TIMESTAMP},
      </if>
      <if test="password != null" >
        password = #{password,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
       <if test="openId != null" >
        openId = #{openId,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.surpass.mvc.system.bas.model.Member" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Aug 08 09:25:27 CST 2018.
    -->
    update t_sys_member
    set name = #{name,jdbcType=VARCHAR},
      level = #{level,jdbcType=VARCHAR},
      headImg = #{headimg,jdbcType=VARCHAR},
      cardNumber = #{cardnumber,jdbcType=VARCHAR},
      cardFaceImg = #{cardfaceimg,jdbcType=VARCHAR},
      cardConImg = #{cardconimg,jdbcType=VARCHAR},
      mobilePhone = #{mobilephone,jdbcType=VARCHAR},
      createTime = #{createtime,jdbcType=TIMESTAMP},
      commendNo = #{commendno,jdbcType=VARCHAR},
      ways = #{ways,jdbcType=VARCHAR},
      personNo = #{personno,jdbcType=VARCHAR},
      beginTime = #{begintime,jdbcType=TIMESTAMP},
      endTime = #{endtime,jdbcType=TIMESTAMP},
      password = #{password,jdbcType=VARCHAR},
      status = #{status,jdbcType=VARCHAR},
      openId = #{openId,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
	<!-- 查询会员数据列表  -->
	<select id="query" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="map">
		select t.*,date_format(t.createTime, '%Y-%m-%d %H:%i:%s'),if((t.endTime-now())>1,'0','1') as isOver from t_sys_member t
		<where>
			<if test="member.name != null and member.name !='' ">
				and t.name like CONCAT(#{member.name},'%' )
			</if>
		</where>
		order by t.createTime
		<![CDATA[
            limit #{start}, #{limit}        
      	]]>
	</select>
	
	<!-- 查询用户信息数据条数 -->
	<select id="total" resultType="Integer" parameterType="com.surpass.mvc.system.bas.model.Member">
		select count(id) from t_sys_member
	</select>
	<!-- 查询用户是否存在 -->
	<select id="verifyMember" resultType="Integer" parameterType="com.surpass.mvc.system.bas.model.Member">
		select count(id) from t_sys_member
		<where>
			<if test="mobilephone != null and mobilephone !='' ">
				AND mobilePhone=#{mobilephone}
			</if>
		</where>
	</select>
	<!-- 查询推荐码是否存在 -->
	<select id="selectByCommendNO" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="com.surpass.mvc.system.bas.model.Member">
		select t.* from t_sys_member t where
		t.commendNo = #{commendno,jdbcType=VARCHAR}
	</select>
	
	<!-- 查询手机号是否存在 -->
	<select id="selectByMobilePhone" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="com.surpass.mvc.system.bas.model.Member">
		select t.* from t_sys_member t where
		t.mobilephone = #{mobilephone,jdbcType=VARCHAR}
	</select>
	
	<!-- 查询我的下级会员-->
	<select id="selectByPersonNO" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="com.surpass.mvc.system.bas.model.Member">
		select t.*,if((t.endTime-now())>1,'0','1') as isOver from t_sys_member t where
		t.personNo = #{commendno,jdbcType=VARCHAR}
	</select>
	<!-- 通过openId查询会员-->
	<select id="getMemberByopenId" resultType="com.surpass.mvc.system.bas.model.Member" parameterType="com.surpass.mvc.system.bas.model.Member">
		select t.* from t_sys_member t where
		t.openId = #{openId,jdbcType=VARCHAR}
	</select>
</mapper>