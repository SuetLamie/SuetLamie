<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.surpass.mvc.system.sys.dao.SysLogMapper">

	<!-- 查询日志信息 -->
	<select id="query" resultType="com.surpass.mvc.system.sys.model.SysLog" parameterType="map">
		SELECT t.*, date_format(t.c_time, '%Y-%m-%d %T') c_time_format
		FROM t_sys_log t
		<where>
			<if test="sysLog.user_account != null and sysLog.user_account!='' ">
				and user_account like CONCAT('%','${sysLog.user_account}','%' )
			</if>
			<if test="sysLog.success != null and sysLog.success !='-1' and sysLog.success !='' ">
				and success = #{sysLog.success}
			</if>
		</where>
		 order by c_time desc
		<![CDATA[
            limit #{start}, #{limit}        
      	]]>
	</select>

	<!-- 查询日志信息数据条数 -->
	<select id="total" resultType="Integer" parameterType="com.surpass.mvc.system.sys.model.SysLog">
		SELECT count(*)
		FROM t_sys_log t
		<where>
			<if test="user_account != null and user_account!='' ">
				and user_account like CONCAT('%','${user_account}','%' )
			</if>
			<if test="success != null and success !='-1' and success !='' ">
				and success = #{success}
			</if>
		</where>
	</select>

	<insert id="insert" parameterType="com.surpass.mvc.system.sys.model.SysLog">
		insert into t_sys_log (
		<!-- id, -->
		business,
		oper_type,
		oper_key,
		content,
		success,
		user_account,
		c_time
		)values (
		<!-- #{id,jdbcType=INTEGER}, -->
		#{business,jdbcType=VARCHAR},
		#{oper_type,jdbcType=VARCHAR},
		#{oper_key,jdbcType=VARCHAR},
		#{content,jdbcType=VARCHAR},
		#{success,jdbcType=CHAR},
		#{user_account,jdbcType=VARCHAR},
		now()
		)
	</insert>

</mapper>